<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>气泡</title>
	<style>

	</style>

</head>
<body>
	<canvas id="canvas" width="" height=""></canvas>
</body>
	<script>
		var canvas=document.getElementById('canvas');
		canvas.width=window.innerWidth;
		canvas.height=window.innerHeight;
		var context=canvas.getContext('2d');
		var balls=[];
		var colors=['#69D2E7','#A7DBD8','#E0E4CC','#F38630','#FA6900','#FF4E50','#F9D423'];
		var timer;
		function draw(ball) {
			context.beginPath();
			context.arc(ball.x,ball.y,ball.r,0,2*Math.PI);
			context.fillStyle=ball.color;
			context.globalCompositeOperation='lighter';
			context.fill();
		}
		function random(min,max){
			return Math.round(Math.random()*(max-min)+min);
		}
		var on=true;
		canvas.onmousemove=function(ev){
			for(var i=0;i<2;i++){
				var ball={
					x:random(-5,5)+ev.clientX,
					y:random(-5,5)+ev.clientY+window.pageYOffset,
					r:random(10,45),
					vx:Math.random()-0.5,
					vy:Math.random()-0.5,
					color:colors[random(0,colors.length-1)]
				};
				balls.push(ball);
				if(balls.length>300){
					balls.shift();
				}
			}
			if(on){
				clearInterval(timer);
				timer=setInterval(drawBall,30);
				on=false;
			}
			
			function drawBall(){
				context.clearRect(0,0,canvas.width,canvas.height);
				for(var i=0;i<balls.length;i++){
					balls[i].x+=balls[i].vx*8;
					balls[i].y+=balls[i].vy*8;
					balls[i].r=balls[i].r*0.94;
					balls[i].index=i;
					if(balls[i].r<1){
						balls.splice(balls[i].index,1);
					}else
					draw(balls[i]);
				}
				if(!balls.length){
					clearInterval(timer);
					on=true;
				}
			}
		}

	</script>
</html>